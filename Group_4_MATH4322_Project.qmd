---
title: "Group Project Team 4"
author: "Alejandro Avila, Anthony Ramirez, Benjamin B An, Chengze Liu, Vishu Kodikanti"
format: pdf
editor: visual
---

## 

```{r}
#importing the data set and displaying the summary
strength<-read.csv("C:/Users/alex-/OneDrive/Desktop/Concrete.csv")
summary(strength)

```
```{r}
any(is.na(strength))
```
## Introduction

Concrete is the most important material in civil engineering, and concrete compressive strength is one determining factor for concrete performance. Concrete chemical compositions, physical formations, as well as age, may impact concrete compressive strength. In courtesy of I-Cheng Yeh from UC Irvine Machine Learning Depository, we look at the data set **Concrete Compressive Strength**, and model for concrete compressive strength using linear regression and random forest. Our goal is to find out the best model and the most important predictors to help us predict for concrete compressive strength.

## Data Set

The data set contains 1030 observations and 9 variables:

Prdictors:
- Cement: measured in kilograms per cubic meter (kg/m^3).
- Blast Furnace slag: measured in kilograms per cubic meter (kg/m^3).
- Fly Ash: measured in kilograms per cubic meter (kg/m^3).
- Water: measured in kilograms per cubic meter (kg/m^3).
- Superplasticizer: measured in kilograms per cubic meter (kg/m^3).
- Coarse Aggregate: measured in kilograms per cubic meter (kg/m^3).
- Fine Aggregate: measured in kilograms per cubic meter (kg/m^3).
- Age: measured in days.
Response: 
- Concrete compression strength: measured in megapascals (MPa).

## Linear Regression

The linear regression model we are going to use is: 

Strength = $\beta_0$ +$\beta_1$ $\times$ Cement + $\beta_2$ $\times$ Blast Furnace Slag + $\beta_3$ $\times$ Fly Ash+ $\beta_4$ $\times$ Water
+$\beta_5$ $\times$ Superplasticizer+ $\beta_6$ $\times$ Coarse Aggregate+$\beta_7$ $\times$ Fine Aggregate+ $\beta_8$ $\times$ Age +$\epsilon$

#Creating the linear regression model 
```{r}
strength.lm = lm(Concrete_Strength ~ .,data=strength)
summary(strength.lm)

```
#creating the plots
```{r}
par(mfrow = c(2, 2))
plot(strength.lm)
```
```{r}
MSE <- rep(0, 10)

for (i in 1:10) {
  set.seed(i)
  sample <- sample(1:nrow(strength), 0.8 * nrow(strength))
  train_data <- strength[sample, ]  
  test_data <- strength[-sample, ]  
  
  numeric_cols <- sapply(train_data, is.numeric)
  train_data_scaled <- as.data.frame(scale(train_data[, numeric_cols]))
  test_data_scaled <- as.data.frame(scale(test_data[, numeric_cols]))
  
  # Fit linear regression model
  strength.lm <- lm(Concrete_Strength ~ ., data = train_data_scaled)
  
  # Make predictions
  yhat <- predict(strength.lm, newdata = test_data_scaled)
  
  # Calculate MSE
  MSE[i] <- mean((yhat - test_data_scaled$Concrete_Strength)^2)
}

cat("MSE Values:", MSE, "\n")
cat("Average Test MSE:", mean(MSE), "\n")



```

## Random Forest

We separate the data set to training and test (70/30).

```{r}
library(randomForest)
set.seed(200)
rf_train_subset = sample(1:nrow(Concrete), nrow(Concrete)*0.7)
test.sample = Concrete[-rf_train_subset,]
rf.concrete = randomForest(Concrete_Strength ~ . , data = Concrete, subset = rf_train_subset, mtry = ncol((Concrete)-1)/3, importance = TRUE)
varImpPlot(rf.concrete)
yhat_test = predict(rf.concrete, newdata = test.sample)
(rf.MSE = mean(test.sample$Concrete_Strength - yhat_test)^2)

MSE_vector = rep(0,10)
for (i in 1:10) {
  set.seed(i) 
  sample <- sample(1:nrow(Concrete), 0.7 * nrow(Concrete))
  train_data <- Concrete[sample, ]
  test_data <- Concrete[-sample, ]
  
  #scaling numeric variables to have zero mean and unit variance (min-max scaling)
  numeric_cols <- sapply(train_data, is.numeric)
  train_data_scaled <- as.data.frame(scale(train_data[, numeric_cols]))
  test_data_scaled <- as.data.frame(scale(test_data[, numeric_cols]))
  
  concrete.rf = randomForest(Concrete_Strength ~., 
                            data = train_data_scaled,
                            mtry = (ncol(Concrete)-1) / 3, importance = TRUE)
  
  yhat.rf = predict(concrete.rf, newdata = test_data_scaled)
  MSE_vector[i] = mean((yhat.rf - test_data_scaled$Concrete_Strength)^2)
}

cat("MSE Values:", MSE_vector, "\n")
cat("Average Test MSE:", mean(MSE_vector), "\n")

```
