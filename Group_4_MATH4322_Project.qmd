---
title: "Concrete Compressive Strength."
subtitle: "Group 4 Team Project."
author: "Alejandro Avila, Anthony Ramirez, Benjamin B An, Chengze Liu, Vishu Kodikanti."
format: pdf
highlight-style: github
editor: visual
code-block-bg: true
code-block-border-left: "#31BAE9"
title-block-style: plain
header-includes: 
- \newcommand{\bi}{\begin{itemize}}
- \newcommand{\ei}{\end{itemize}}
- \newcommand{\iset}{\setlength\itemsep{1em}}
- \definecolor{darkgreen}{RGB}{0,100,0} 
- \definecolor{darkorange}{RGB}{210,102,0}
- \usepackage{amsbsy}
- \usepackage{hyperref}
- \newcommand{\blue}[1]{\textcolor{blue}{#1}}
- \newcommand{\red}[1]{\textcolor{red}{#1}}
- \newcommand{\customgreen}[1]{\textcolor{darkgreen}{#1}}
- \newcommand{\highlighted}[1]{\textcolor{blue}{\colorbox{yellow}{#1}}}
- \newcommand{\customred}[1]{\textcolor{red}{#1}}

---



```{r echo=FALSE, out.width = '100%'}
knitr::include_graphics("concrete.jpg")
```

\newpage

\raggedright

## Introduction

Concrete is the most important material in civil engineering, and concrete compressive strength is one determining factor for concrete performance. The chemical compositions, physical formations, as well as the age of concrete, may impact its compressive strength. With gratitude to I-Cheng Yeh from UC Irvine Machine Learning Repository, we examine the data set **Concrete Compressive Strength**. We create two different models using the concrete compressive strength data set: one utilizing linear regression and the other employing a random forest approach. Our goal is to determine the best model and identify the most significant predictors to aid in predicting concrete compressive strength.

## Dataset Description

The data set provided by the UC Irvine Machine Learning Repository will help us investigate the influence of different materials on concrete compression strength. This data set includes 1030 observations and 9 variables, with 8 of them being predictors and 1 being the response variable, together they provide a rich and comprehensive resource for our analysis. Each piece of data in this data set tells us about a specific mix of materials, how they are assembled, and the conditions they are subjected to. The data set helps to identify all the factors contributing to the strength of concrete. In the following sections, we will provide detailed information about these variables:

## Predictors:
\begin{itemize}
    \item \textbf{\textit{Cement}}: is a continuous numerical value measured in kilograms per cubic meter (kg/m\textsuperscript{3}) and is the binder that sets,hardens and adheres to other materials to bind them together.
    \item \textbf{\textit{Blast Furnace Slag}}: is an integer numerical value measured in kilograms per cubic meter (kg/m\textsuperscript{3}) and is a byproduct of iron when added to concrete improves its properties suck as workability, strength and durability.
    \item \textbf{\textit{Fly Ash}}: is a continuous numerical value measured in kilograms per cubic meter (kg/m\textsuperscript{3}) and is a byproduct of coal power plants that can be used to improve durability and workability of concrete mixes.
    \item \textbf{\textit{Water}}: is a numerical continuous value measured in kilograms per cubic meter (kg/m\textsuperscript{3}) and water is added to concrete that helps to create a paste that glues all aggregates together.
    \item \textbf{\textit{Superplasticizer}}: is a numerical continuous value measured in kilograms per cubic meter and is an admixture that transforms stiff, low-slump concrete into flowing, pourable and easily placed concrete.
    \item \textbf{\textit{Coarse Aggregate}}: is a numerical continuous value measured in kilograms per cubic meter (kg/m\textsuperscript{3}) and is typically made up of crushed stone, gravel, or recycled concrete. It is used to provide bulk to the concrete mixture, which helps to reduce shrinkage and cracking.
    \item \textbf{\textit{Fine Aggregate}}: is a numerical continuous value measured in kilograms per cubic meter (kg/m\textsuperscript{3}) and is a term used to describe small, inert materials, whether granular or crushed stone. These fine aggregates are essential components in concrete mixtures and play a crucial role in determining the properties of the resulting concrete.
    \item \textbf{\textit{Age}}: is an integer numerical value measured in days and this variable refers to the number of days since the concrete sample was created or cast.
\end{itemize}


## Response:

\begin{itemize}
\item \textbf{\textit{Concrete compression strength}}: is a continuous numerical variable measured in megapascals (MPa) and is our target variable and refers to the amount of force concrete can handle when force is applied.
\end{itemize}

## 

```{r}
#importing the data set and displaying the summary
strength<-read.csv("C:/Users/alex-/OneDrive/Desktop/Concrete.csv")
summary(strength)

```
```{r}
any(is.na(strength))
```


## Linear Regression

The linear regression model we are going to use is: 

Strength = $\beta_0$ +$\beta_1$ $\times$ Cement + $\beta_2$ $\times$ Blast Furnace Slag + $\beta_3$ $\times$ Fly Ash+ $\beta_4$ $\times$ Water
+$\beta_5$ $\times$ Superplasticizer+ $\beta_6$ $\times$ Coarse Aggregate+$\beta_7$ $\times$ Fine Aggregate+ $\beta_8$ $\times$ Age +$\epsilon$

#Creating the linear regression model 
```{r}
strength.lm = lm(Concrete_Strength ~ .,data=strength)
summary(strength.lm)

```
#creating the plots
```{r}
par(mfrow = c(2, 2))
plot(strength.lm)
```
```{r}
MSE <- rep(0, 10)

for (i in 1:10) {
  set.seed(i)
  sample <- sample(1:nrow(strength), 0.8 * nrow(strength))
  train_data <- strength[sample, ]  
  test_data <- strength[-sample, ]  
  
  numeric_cols <- sapply(train_data, is.numeric)
  train_data_scaled <- as.data.frame(scale(train_data[, numeric_cols]))
  test_data_scaled <- as.data.frame(scale(test_data[, numeric_cols]))
  
  # Fit linear regression model
  strength.lm <- lm(Concrete_Strength ~ ., data = train_data_scaled)
  
  # Make predictions
  yhat <- predict(strength.lm, newdata = test_data_scaled)
  
  # Calculate MSE
  MSE[i] <- mean((yhat - test_data_scaled$Concrete_Strength)^2)
}

cat("MSE Values:", MSE, "\n")
cat("Average Test MSE:", mean(MSE), "\n")



```

## Random Forest

We separate the data set to training and test (70/30).

```{r}
library(randomForest)
set.seed(200)
rf_train_subset = sample(1:nrow(strength), nrow(strength)*0.7)
test.sample = strength[-rf_train_subset,]
rf.strength = randomForest(Concrete_Strength ~ . , data = strength, subset = rf_train_subset, mtry = ncol((strength)-1)/3, importance = TRUE)
varImpPlot(rf.strength)
yhat_test = predict(rf.strength, newdata = test.sample)
(rf.MSE = mean(test.sample$Concrete_Strength - yhat_test)^2)

MSE_vector = rep(0,10)
for (i in 1:10) {
  set.seed(i) 
  sample <- sample(1:nrow(strength), 0.7 * nrow(strength))
  train_data <- strength[sample, ]
  test_data <- strength[-sample, ]
  
  #scaling numeric variables to have zero mean and unit variance (min-max scaling)
  numeric_cols <- sapply(train_data, is.numeric)
  train_data_scaled <- as.data.frame(scale(train_data[, numeric_cols]))
  test_data_scaled <- as.data.frame(scale(test_data[, numeric_cols]))
  
  concrete.rf = randomForest(Concrete_Strength ~., 
                            data = train_data_scaled,
                            mtry = (ncol(strength)-1) / 3, importance = TRUE)
  
  yhat.rf = predict(concrete.rf, newdata = test_data_scaled)
  MSE_vector[i] = mean((yhat.rf - test_data_scaled$Concrete_Strength)^2)
}

cat("MSE Values:", MSE_vector, "\n")
cat("Average Test MSE:", mean(MSE_vector), "\n")

```
